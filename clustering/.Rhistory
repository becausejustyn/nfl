x = feature,
y = z_val,
colour = .cluster)) +
geom_point() +
scale_color_brewer(palette = "Paired") +
gghighlight(use_direct_label = FALSE) + # highlight each cluster
facet_wrap(~ .cluster, ncol=2) + # create seperate plots for each cluster
labs(
x = "Predictor",
y = "Cluster Center",
title = "Visualizing K-Means Cluster Makeups") +
becausejustynfun::white_theme() +
theme(
legend.position = "none",
strip.text = element_text(face='bold'),
axis.text.x = element_text(angle = 90, size = 8), # alter axis text
panel.grid.minor = element_blank())
clust_cen_long %>%
select(-rank) %>%
ggplot(aes(
x = feature,
y = z_val,
colour = .cluster)) +
geom_point() +
scale_color_brewer(palette = "Paired") +
gghighlight(use_direct_label = FALSE) + # highlight each cluster
facet_wrap(~ .cluster, ncol=2) + # create seperate plots for each cluster
labs(
x = "Predictor",
y = "Cluster Center",
title = "Visualizing K-Means Cluster Makeups") +
becausejustynfun::white_theme() +
theme(
legend.position = "none",
strip.text = element_text(face='bold'),
axis.text.x = element_text(angle = 90, size = 8), # alter axis text
panel.grid.minor = element_blank())
clust_cen_long
clust_cen
clust_cen %>%
select(where(is.numeric), .cluster, -rank)
clust_cen_long <- clust_cen %>%
select(where(is.numeric), .cluster, -rank) %>%
rename(c(
'Pass YPP' = 'pass_ypp',
'Rush YPP' = 'run_ypp',
'Pass Minus Rush' = 'pass_minus_run'
)) %>%
# pivot data to make plotting easier
pivot_longer(
!.cluster,
names_to = 'feature',
values_to = 'z_val')
team_clusters <- select(clust_cen, posteam, .cluster)
clust_cen_long %>%
ggplot(aes(
x = feature,
y = z_val,
colour = .cluster)) +
geom_point() +
scale_color_brewer(palette = "Paired") +
gghighlight(use_direct_label = FALSE) + # highlight each cluster
facet_wrap(~ .cluster, ncol=2) + # create seperate plots for each cluster
labs(
x = "Predictor",
y = "Cluster Center",
title = "Visualizing K-Means Cluster Makeups") +
becausejustynfun::white_theme() +
theme(
legend.position = "none",
strip.text = element_text(face='bold'),
axis.text.x = element_text(angle = 90, size = 8), # alter axis text
panel.grid.minor = element_blank())
clust_cen_long %>%
ggplot(aes(
x = feature,
y = z_val,
colour = .cluster)) +
geom_point() +
scale_color_brewer(palette = "Paired") +
gghighlight(use_direct_label = FALSE) +
facet_wrap(~ .cluster, ncol=2) +
labs(
x = "Predictor",
y = "Cluster Center",
title = "Visualizing K-Means Cluster Makeups") +
becausejustynfun::white_theme() +
theme(
legend.position = "none",
strip.text = element_text(face='bold'),
axis.text.x = element_text(angle = 90, size = 8), # alter axis text
panel.grid.minor = element_blank())
clust_cen_long %>%
ggplot(aes(
x = feature,
y = z_val,
colour = .cluster)) +
geom_point() +
scale_color_brewer(palette = "Paired") +
gghighlight(use_direct_label = FALSE) +
facet_wrap(~ .cluster, ncol=2) +
labs(
x = "Predictor",
y = "Cluster Center",
title = "Visualizing K-Means Cluster Makeups") +
becausejustynfun::white_theme() +
theme(
legend.position = "none",
strip.text = element_text(face='bold'),
axis.text.x = element_text(angle = 90, size = 8), # alter axis text
panel.grid.minor = element_blank())
team_clusters
pass_run_stats
team_clusters <- team_clusters %>%
left_join(pass_run_stats)
team_clusters %>% names()
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(yintercept = mean(team_clusters$run_ypp), color = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(xintercept =  mean(team_clusters$pass_ypp), color = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(size = 3, color = team_clusters$cluster, alpha = .8) +
#add names using ggrepel, which tries to make them not overlap
geom_text_repel(aes(label = team)) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm')+
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme()
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(colour = .cluster), size = 3, alpha = .8) +
#add names using ggrepel, which tries to make them not overlap
geom_text_repel(aes(label = posteam)) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm')+
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme()
team_clusters
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(colour = .cluster), size = 3, alpha = .8) +
#add names using ggrepel, which tries to make them not overlap
geom_text_repel(aes(label = posteam, colour = team_color)) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm')+
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme()
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(colour = .cluster), size = 3, alpha = .8) +
#add names using ggrepel, which tries to make them not overlap
geom_text_repel(aes(label = posteam, colour = team_color)) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
scale_color_identity(aesthetics = c('colour')) +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme()
?aes
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(colour = .cluster), size = 3, alpha = .8) +
#add names using ggrepel, which tries to make them not overlap
geom_text_repel(aes(label = posteam, colour = team_color, inherit.aes = FALSE)) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
scale_color_identity(aesthetics = c('colour')) +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme()
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(colour = .cluster), size = 3, alpha = .8) +
#add names using ggrepel, which tries to make them not overlap
geom_text_repel(aes(label = posteam, colour = team_color, inherit.aes = FALSE)) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
scale_color_identity(aesthetics = c('colour')) +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10))
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(colour = .cluster), size = 3, alpha = .8) +
#add names using ggrepel, which tries to make them not overlap
geom_text_repel(aes(label = posteam, colour = team_color), inherit.aes = FALSE) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
scale_color_identity(aesthetics = c('colour')) +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme()
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(color = .cluster), size = 3, alpha = .8) +
#add names using ggrepel, which tries to make them not overlap
geom_text_repel(aes(label = posteam, colour = team_color)) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
scale_color_identity(aesthetics = c('colour')) +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme()
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(color = .cluster), size = 3, alpha = .8) +
#add names using ggrepel, which tries to make them not overlap
geom_text_repel(aes(label = posteam, colour = team_color)) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
scale_color_identity(aesthetics = c('colour')) +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme() +
scale_color_manual(values = colors)
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(color = .cluster), size = 3, alpha = .8) +
#add names using ggrepel, which tries to make them not overlap
geom_text_repel(aes(label = posteam, colour = team_color)) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
scale_color_identity(aesthetics = c('colour')) +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme() +
scale_color_manual(values = .cluster)
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(color = .cluster), size = 3, alpha = .8) +
#add names using ggrepel, which tries to make them not overlap
geom_text_repel(aes(label = posteam, colour = team_color)) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
scale_color_identity(aesthetics = c('colour')) +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme() +
scale_color_manual(aes(values = .cluster))
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(color = .cluster), size = 3, alpha = .8) +
#add names using ggrepel, which tries to make them not overlap
geom_text_repel(aes(label = posteam, colour = team_color)) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
scale_color_identity(aesthetics = c('colour')) +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme() +
guides(color = TRUE)
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(color = .cluster), size = 3, alpha = .8) +
#add names using ggrepel, which tries to make them not overlap
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme()
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(color = .cluster), size = 3, alpha = .8) +
scale_color_manual(values = c('#009392', '#9ccb86', '#eeb479', '#B86C70', '#88CCEE')) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme()
p1 <- team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(color = .cluster), size = 3, alpha = .8) +
scale_color_manual(values = c('#009392', '#9ccb86', '#eeb479', '#B86C70', '#88CCEE')) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme()
p1 + geom_text_repel(aes(label = posteam, colour = team_color)) +
scale_color_identity(aesthetics = c('colour'))
p1
p1 + geom_text_repel(aes(label = posteam, colour = team_color))
p1 + geom_text_repel(aes(label = posteam), colour = team_clusters$team_color)
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(color = .cluster), size = 3, alpha = .8) +
scale_color_manual(values = c('#009392', '#9ccb86', '#eeb479', '#B86C70', '#88CCEE')) +
geom_text_repel(aes(label = posteam), colour = team_clusters$team_color) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme()
team_clusters <- team_clusters %>%
left_join(pass_run_stats)
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(color = .cluster), size = 3, alpha = .8) +
scale_color_manual(values = c('#009392', '#9ccb86', '#eeb479', '#B86C70', '#88CCEE')) +
geom_text_repel(aes(label = posteam), colour = team_clusters$team_color) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme()
team_clusters %>%
ggplot(aes(
x = pass_ypp,
y = run_ypp)) +
geom_hline(aes(yintercept = mean(run_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_vline(aes(xintercept =  mean(pass_ypp)), colour = "blue", linetype = "dashed", alpha = 0.5) +
geom_point(aes(color = .cluster), size = 3, alpha = .8) +
scale_color_manual(values = c('#009392', '#9ccb86', '#eeb479', '#B86C70', '#88CCEE')) +
geom_text_repel(aes(label = posteam), colour = team_clusters$team_color) +
#add a smooth line fitting cpoe + epa
stat_smooth(geom = 'line', alpha = 0.5, se = FALSE, method = 'lm') +
#titles and caption
labs(
x = "Pass YPP",
y = "Rush YPP",
title = "Clustering Analysis of the YPP of NFL Teams",
caption = "By me") +
#uses the black and white ggplot theme
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
becausejustynfun::white_theme()
