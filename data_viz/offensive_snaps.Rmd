---
title: "R Notebook"
output: html_notebook
---

## Offensive Snaps by Team

```{r}
library(tidyverse)
```

```{r pfr_scrape}
# https://www.pro-football-reference.com/years/2021/#team_stats

#library(datapasta)

#I copy and pasted the table using the addin. 

off_values <- tibble::tribble(
  ~rank,                        ~team,  ~games,   ~points_for,   ~yards,   ~play_count, ~yards_p_play,  ~turnover_lost, ~fumble_lost, ~first_downs,  ~passes_completed,  ~passes_attempted,   ~pass_yards,  ~pass_td, ~interceptions_thrown, ~net_yards_attempt, ~passing_first_downs,  ~rushing_attempts,   ~rushing_yards,  ~rushing_td, ~rushing_yards_attempt, ~rushing_first_downs,  ~penalties_against_accepted,  ~penalty_yards_against, ~first_downs_by_penalty, ~drive_success_rate, ~drive_turnover_rate,    ~expected_points,
   1L,           "Dallas Cowboys", 17L,   530,   6895,   1153,      6,   20,   9,     390,   444,   647,   4791,   40,   11,       7,     248,   473,   2104,   15,    4.4,     111,   127,  1103,       31,   43.8,    9.9,  158.06,
   2L,     "Tampa Bay Buccaneers", 17L,   511,   6897,   1139,    6.1,   19,   7,     404,   492,   731,   5229,   43,   12,     6.9,     273,   385,   1668,   18,    4.3,     106,    97,   874,       25,   44.3,    9.8,  216.14,
   3L,            "Buffalo Bills", 17L,   483,   6493,   1143,    5.7,   22,   6,     398,   415,   655,   4284,   36,   16,     6.3,     236,   461,   2209,   20,    4.8,     134,   113,   980,       28,   45.2,   11.3,  216.68,
   4L,       "Kansas City Chiefs", 17L,   480,   6746,   1134,    5.9,   25,  12,     419,   448,   675,   4791,   37,   13,     6.8,     267,   431,   1955,   16,    4.5,     119,   111,   925,       33,   48.2,   13.7,  250.49,
   5L,     "Los Angeles Chargers", 17L,   474,   6629,   1128,    5.9,   22,   7,     401,   443,   674,   4800,   38,   15,     6.8,     256,   423,   1829,   18,    4.3,     112,   116,  1033,       33,   45.7,     12,  164.91,
   6L,     "New England Patriots", 17L,   462,   6004,   1052,    5.7,   23,  10,     362,   364,   535,   3857,   24,   13,     6.9,     187,   489,   2147,   24,    4.4,     139,    95,   854,       36,     48,   12.6,  126.97,
   7L,       "Cincinnati Bengals", 17L,   460,   6141,   1046,    5.9,   21,   7,     337,   384,   555,   4401,   36,   14,     7.2,     208,   436,   1740,   16,      4,      96,    72,   620,       33,   42.6,     10,  115.59,
   8L,         "Los Angeles Rams", 17L,   460,   6320,   1058,      6,   23,   5,     355,   406,   607,   4642,   41,   18,     7.3,     233,   420,   1678,   10,      4,      99,    76,   637,       23,   45.9,   12.2,  151.06,
   9L,       "Indianapolis Colts", 17L,   451,   5901,   1052,    5.6,   19,  11,     354,   324,   521,   3361,   27,    8,     6.1,     167,   499,   2540,   22,    5.1,     154,    76,   688,       33,   43.3,    8.9,  127.06,
  10L,        "Green Bay Packers", 17L,   450,   6215,   1072,    5.8,   13,   6,     375,   402,   593,   4315,   39,    7,     6.9,     235,   446,   1900,   13,    4.3,     109,    69,   683,       31,   44.5,    6.4,  180.42,
  11L,        "Arizona Cardinals", 17L,   449,   6332,   1126,    5.6,   15,   4,     367,   415,   591,   4275,   27,   11,     6.8,     214,   496,   2057,   23,    4.1,     127,   114,   990,       26,   44.7,    7.8,  119.94,
  12L,      "Philadelphia Eagles", 17L,   444,   6126,   1075,    5.7,   16,   6,     352,   307,   494,   3411,   20,   10,     6.5,     167,   550,   2715,   25,    4.9,     163,   107,   842,       22,   43.4,    9.2,  113.05,
  13L,      "San Francisco 49ers", 17L,   427,   6383,   1046,    6.1,   24,  10,     360,   343,   514,   4221,   26,   14,     7.7,     199,   499,   2162,   22,    4.3,     130,   102,  1066,       31,   41.2,   11.5,  126.28,
  14L,        "Minnesota Vikings", 17L,   425,   6168,   1083,    5.7,   13,   6,     332,   398,   604,   4238,   34,    7,     6.7,     202,   449,   1930,   10,    4.3,     103,   111,  1043,       27,   39.3,    6.6,   72.05,
  15L,         "Tennessee Titans", 17L,   419,   5825,   1133,    5.1,   25,  11,     362,   359,   535,   3418,   22,   14,     5.9,     194,   551,   2407,   23,    4.4,     134,   103,   973,       34,   38.9,     13,   79.19,
  16L,         "Seattle Seahawks", 17L,   395,   5506,    954,    5.8,   13,   6,     302,   324,   495,   3432,   30,    7,     6.3,     166,   413,   2074,   18,      5,     106,    97,   803,       30,   34.8,      7,  101.56,
  17L,         "Baltimore Ravens", 17L,   387,   6438,   1185,    5.4,   26,   8,     394,   396,   611,   3961,   21,   18,     5.9,     209,   517,   2477,   18,    4.8,     159,   102,   852,       26,   38.5,   13.3,   59.67,
  18L,        "Las Vegas Raiders", 17L,   374,   6179,   1082,    5.7,   24,  10,     349,   429,   628,   4567,   23,   14,     6.8,     217,   414,   1612,   14,    3.9,      95,   124,  1104,       37,     41,   12.8,   77.89,
  19L,       "New Orleans Saints", 17L,   364,   5175,   1051,    4.9,   18,   5,     307,   293,   504,   3186,   29,   13,     5.9,     165,   510,   1989,   12,    3.9,     113,    98,   811,       29,   33.7,    8.7,  -11.97,
  20L,         "Cleveland Browns", 17L,   349,   5790,   1054,    5.5,   22,   8,     342,   320,   520,   3320,   21,   14,     5.8,     177,   485,   2470,   20,    5.1,     138,   112,  1035,       27,   32.2,   12.4,   58.49,
  21L,      "Pittsburgh Steelers", 17L,   343,   5339,   1113,    4.8,   20,   9,     323,   425,   664,   3775,   23,   11,     5.4,     204,   411,   1564,   10,    3.8,      85,   106,   831,       34,   34.7,    9.5,  -14.49,
  22L,           "Miami Dolphins", 17L,   341,   5217,   1097,    4.8,   26,  12,     325,   404,   615,   3656,   21,   14,     5.6,     206,   442,   1561,   12,    3.5,      87,   105,   825,       32,   30.1,   12.4,  -11.96,
  23L,           "Denver Broncos", 17L,   335,   5608,   1036,    5.4,   18,   9,     331,   354,   541,   3592,   20,    9,     6.2,     179,   455,   2016,   16,    4.4,     124,    83,   711,       28,   36.9,    9.5,   61.32,
  24L, "Washington Football Team", 17L,   335,   5488,   1070,    5.1,   24,   9,     345,   356,   550,   3433,   21,   15,     5.8,     181,   477,   2055,   13,    4.3,     129,    82,   743,       35,   34.6,   13.4,    15.8,
  25L,            "Detroit Lions", 17L,   325,   5483,   1056,    5.2,   23,   9,     329,   396,   593,   3598,   23,   14,     5.7,     193,   427,   1885,   12,    4.4,     104,   105,   824,       32,   34.3,   12.9,    6.87,
  26L,          "Atlanta Falcons", 17L,   313,   5160,   1006,    5.1,   26,  11,     306,   377,   573,   3713,   20,   15,     6.1,     196,   393,   1447,   11,    3.7,      75,    92,   753,       35,   32.8,   14.7,  -18.38,
  27L,            "Chicago Bears", 17L,   311,   5214,   1075,    4.9,   29,   9,     333,   332,   542,   3204,   16,   20,     5.3,     180,   475,   2010,   14,    4.2,     119,   106,   914,       34,   31.5,   15.2,  -40.89,
  28L,            "New York Jets", 17L,   310,   5206,   1036,      5,   27,   7,     310,   357,   603,   3541,   20,   20,     5.4,     195,   380,   1665,   14,    4.4,      87,   103,   860,       28,   29.4,   14.4,  -32.71,
  29L,        "Carolina Panthers", 17L,   304,   5075,   1106,    4.6,   29,   8,     322,   348,   599,   3239,   14,   21,       5,     174,   455,   1836,   17,      4,     118,   107,   864,       30,   29.2,   14.9,   -92.1,
  30L,           "Houston Texans", 17L,   280,   4728,   1010,    4.7,   22,   7,     266,   354,   546,   3305,   21,   15,     5.6,     162,   420,   1423,    8,    3.4,      77,   114,   978,       27,   26.6,   11.2,  -74.29,
  31L,          "New York Giants", 17L,   258,   4884,   1050,    4.7,   30,  10,     299,   351,   593,   3196,   15,   20,     5.1,     171,   419,   1688,    8,      4,      90,    88,   674,       38,   27.5,   15.9, -100.13,
  32L,     "Jacksonville Jaguars", 17L,   253,   5188,   1028,      5,   29,  12,     304,   361,   604,   3436,   12,   17,     5.4,     178,   392,   1752,   13,    4.5,      92,   104,   856,       34,   26.4,   15.7,  -42.52
  )

#write_csv(off_values, "off_values.csv")
```

```{r offensive_snaps_df}
off_values <- off_values %>%
  left_join(
    nflfastR::teams_colors_logos %>% 
      select(team_abbr, team_name, team_color, team_color2, team_color3, team_color4), 
    by = c("team" = "team_name")) 

off_values_plot <- off_values %>%
  ggplot() +
  geom_col(
    aes(x = play_count, y = fct_reorder(team_abbr, play_count),
        fill = team_color, colour = team_color2), alpha = 0.6, width = 0.9, size = 0.5
  ) +
  geom_text(
    aes(x = play_count, y = fct_reorder(team_abbr, play_count), label = play_count, colour = team_color2), 
    hjust = 1, stat = 'unique') +
  coord_cartesian(xlim = c(950, 1200)) +
  scale_x_continuous(breaks = seq(950, 1200, 25)) +
  scale_color_identity(aesthetics = c('fill', 'colour')) +
  #hrbrthemes::theme_ft_rc(base_size = 9.5, axis_title_size = 11) +
  hrbrthemes::theme_ft_rc() +
  labs(
    y = '',
    x = 'Offensive Snaps',
    title = 'Offensive Snaps by Team',
    subtitle = '2021, Regular Season'
  )
```

```{r}
off_values_plot
```

